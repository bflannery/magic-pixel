version: "3"
services:
  test-website:
    container_name: test-website
    build:
      context: test-website
      dockerfile: Dockerfile
    ports:
      - "8080:80"
    volumes:
      - ./test-website/src:/var/www
  browser-service-magic-pixel:
    image: kyma/docker-nginx
    container_name: browser-service-magic-pixel
    restart: "always"
    ports:
      - "8081:80"
    volumes:
      - ./browser-services/magic-pixel/build/index.js:/var/www/magic-pixel.js
  browser-service-event-tracker:
    image: kyma/docker-nginx
    container_name: browser-service-event-tracker
    restart: "always"
    ports:
      - "8082:80"
    volumes:
      - ./browser-services/event-tracker/scribe-analytics/scribe-analytics-debug.js:/var/www/scribe-analytics-debug.js
      - ./browser-services/event-tracker/build/index.js:/var/www/mp-event-tracker.js
  browser-service-page-identification:
    image: kyma/docker-nginx
    container_name: browser-service-page-identification
    restart: "always"
    ports:
      - "8083:80"
    volumes:
      - ./browser-services/page-identification/build/index.js:/var/www/mp-page-identification.js
  db:
    image: postgres
    container_name: pg-docker
    restart: unless-stopped
    environment:
      POSTGRES_PASSWORD: password
    ports:
      - 5432:5432
    volumes:
      - $HOME/docker/volumes/postgres/mp:/var/lib/postgresql/data
  test-db:
    image: postgres
    container_name: pg-test
    restart: unless-stopped
    environment:
      POSTGRES_PASSWORD: password
    ports:
      - 5433:5432
    volumes:
      - $HOME/docker/volumes/postgres/mp-test:/var/lib/postgresql/data
  fake-sqs:
    container_name: fake-sqs
    image: softwaremill/elasticmq-native
    ports:
      - "9324:9324"
      - "9325:9325"
    volumes:
      - ./serverless/config/elasticmq.conf:/opt/elasticmq.conf
